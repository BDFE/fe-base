<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<body>
    <script>
        // to mark the length of need sort number counts in an array; 
        var len = 0;

        function buildHeap(arr) {
            len = arr.length;
            let head = ~~(len / 2);
            console.log('h', head, Math.floor(arr.length / 2))
            for (let i = Math.floor(arr.length / 2); i >= 0; i--) {
                adjustHeap(arr, i);
            }
        }

        // function buildHeap(arr) {
        //     len = arr.length;

        //     for (let i = Math.floor(arr.length / 2); i >= 0; i--) {
        //         adjustHeap(arr, i) //调整堆
        //     }
        // }

        function adjustHeap(arr, i) {
            let maxp = i;
            let lp = 2 * i + 1;
            let rp = 2 * i + 2;
            if (lp < len && arr[lp] > arr[maxp]) {
                maxp = lp;
            }
            if (rp < len && arr[rp] > arr[maxp]) {
                maxp = rp;
            }
            if (maxp !== i) {
                swap(arr, i, maxp)
                adjustHeap(arr, maxp)
            }
        }
        //交换位置
        function swap(arr, i, j) {
            var temp = arr[i]
            arr[i] = arr[j]
            arr[j] = temp
        }

        function heapSort(arr) {
            buildHeap(arr);
            for (var i = arr.length - 1; i > 0; i--) {
                swap(arr, 0, i); // exchange the max to the currnt end i
                len--; // just sort first len count number in the arr, 
                adjustHeap(arr, 0);
            }
            return arr;
        }

        var array = [11, 43, 24, 76, 89, 43, 65]
        heapSort(array)
        console.log(array.join(','));
    </script>

</body>

</html>